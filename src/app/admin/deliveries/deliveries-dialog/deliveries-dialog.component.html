<div class="addContainer">
    <div class="modalHeader">
        <div class="editRowModal">
            <div class="modalHeader clearfix">
                <div class="modal-about">
                    {{dialogTitle}}
                </div>
            </div>
        </div>
        <button mat-icon-button (click)="dialogRef.close()" class="modal-close-button" aria-label="Close dialog">
            <mat-icon>close</mat-icon>
        </button>
    </div>
    <div mat-dialog-content>
        <form class="register-form m-1" [formGroup]="deliveryForm">

            @if (action == 'edit') {
                <div class="row">
                    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                        <section class="example-section">
                            <div class="col-md-6">
                                <mat-slide-toggle class="example-margin" formControlName="is_record_active">Record Active!</mat-slide-toggle>
                                <!-- <mat-checkbox class="example-margin" formControlName="is_record_active" >Record Active</mat-checkbox> -->
                            </div>
                            <div class="col-md-6">
                                <mat-form-field class="example-full-width" appearance="fill">
                                    <mat-label>Stages</mat-label>
                                    <mat-select formControlName="stage_id">
                                        @for (stage of allStages; track stage) {
                                            <mat-option [value]="stage.id">{{stage.stage_name}} </mat-option>
                                        }
                                    </mat-select>
                                </mat-form-field>
                            </div>
                        </section>
                    </div>
                </div> 
            }

            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                    <section class="example-section">
                        <div class="col-md-6">
                            <mat-checkbox class="example-margin" formControlName="is_drop_shipping" >Drop Shipping</mat-checkbox>
                             </div>
                        <div class="col-md-8">
                            <mat-checkbox class="example-margin" formControlName="is_receiver_invoice" >Receiver Invoice</mat-checkbox>
                         </div>
                    </section>
                </div>
            </div> 
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                    <section class="example-section">
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Receiver Partner</mat-label>
                                <mat-select formControlName="receiver_partner_id">
                                    @for (receiver of receiverName; track receiver) {
                                        <mat-option [value]="receiver.id">{{receiver.name}} </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>&nbsp;&nbsp;
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Sender Partner</mat-label>
                                <mat-select formControlName="sender_partner_id">
                                    @for (sender of senderName; track sender) {
                                        <mat-option [value]="sender.id">{{sender.name}} </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>
                    </section>
                </div>
            </div> 
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                    <section class="example-section">
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Category</mat-label>
                                <mat-select formControlName="category_id">
                                    @for (category of categories; track category) {
                                        <mat-option [value]="category.id">{{category?.name}} </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>&nbsp;&nbsp;
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Priority</mat-label>
                                <mat-select formControlName="priority_id">
                                    @for (priority of priorities; track priority) {
                                        <mat-option [value]="priority.id">{{priority?.name}} </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>

                    </section>
                </div>
            </div> 
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                    <section class="example-section">
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width" appearance="fill">
                                <mat-label>Assigne User</mat-label>
                                <mat-select formControlName="assigned_user_id">
                                    @for (user of assignUser; track user) {
                                        <mat-option [value]="user.id">{{user.name}} </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>&nbsp;&nbsp;
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width">
                                <mat-label>Delivery Date</mat-label>
                                <input matInput [matDatepicker]="picker" formControlName="delivery_date" >
                                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                                <mat-datepicker #picker></mat-datepicker>
                              </mat-form-field>
                        </div>
                    </section>
                </div>
            </div> 
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 ">
                    <div class="row">
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width mb-3" appearance="outline">
                                <mat-label>Courier Type</mat-label>
                                <mat-select formControlName="courier_type">
                                    @for (type of deliveryType; track type) {
                                        <mat-option [value]="type">{{type}} </mat-option>
                                    }
                                </mat-select>
                            </mat-form-field>
                        </div>  
                        <div class="col-md-6">
                            <mat-form-field class="example-full-width mb-3" appearance="outline">
                                <mat-label>Distance</mat-label>
                                <input matInput formControlName="distance" required>
                                <mat-error *ngIf="deliveryForm.controls['distance'].hasError('required')">
                                    Distance is required.
                                </mat-error>
                                <mat-error *ngIf="deliveryForm.controls['distance'].hasError('numeric')">
                                    Distance must be a number.
                                </mat-error>
                            </mat-form-field>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 ">
                        <mat-form-field class="example-full-width">
                             <mat-label>Tags</mat-label>
                            <mat-select formControlName="tag_ids" multiple>
                                @for (tag of tagList; track tag) {
                                <mat-option [value]="tag.id">{{tag.value}} </mat-option>
                                }
                            </mat-select>
                        </mat-form-field>
                </div>
            </div>
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 ">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                        <mat-label>Description</mat-label>
                        <textarea matInput formControlName="description" required></textarea>
                        <mat-icon class="material-icons-outlined color-icon p-3" matSuffix>turned_in_not</mat-icon>
                    </mat-form-field>
          
                </div>
            </div>
            <div class="row">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 ">
                    <mat-form-field class="example-full-width mb-3" appearance="outline">
                        <mat-label>Internal Note</mat-label>
                        <textarea matInput formControlName="internal_note" required></textarea>
                        <mat-icon class="material-icons-outlined color-icon p-3" matSuffix>turned_in_not</mat-icon>
                    </mat-form-field>
          
                </div>
            </div>

   
            <div formArrayName="line_items">
                <div *ngFor="let item of lineItems.controls; let i = index" [formGroupName]="i">
                    <div class="row">
                        <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12">
                            <section class="example-section">
                                <mat-form-field>
                                <mat-label>Name</mat-label>
                                <input matInput formControlName="name">
                                </mat-form-field>&nbsp;&nbsp;
                            
                                <mat-form-field>
                                <mat-label>Quantity</mat-label>
                                <input matInput type="number" formControlName="quantity">
                                </mat-form-field>&nbsp;&nbsp;
                    
                                <mat-form-field>
                                <mat-label>Weight</mat-label>
                                <input matInput type="number" formControlName="weight">
                                </mat-form-field>&nbsp;&nbsp; 
                            
                                <mat-form-field >
                                <mat-label>Dimension ID</mat-label>
                                <input matInput type="number" formControlName="dimension_id">
                                </mat-form-field>
                                
                                <button mat-icon-button color="warn" (click)="removeLineItem(i)">
                                <mat-icon>remove_circle</mat-icon>
                                </button>
                            </section>
                        </div>
                    </div>
                </div>
            </div>
            <button mat-raised-button color="primary" type="button" (click)="addLineItem()">
                Add More
            </button><br><br>
   

            <div class="row">
                <div class="col-xl-10 col-lg-10 col-md-12 col-sm-12">
                    <div class="example-button-row">
                        <button mat-raised-button color="primary" type="submit" (click)="confirmAdd()">Save</button>
                        <button mat-raised-button color="warn" (click)="dialogRef.close()" tabindex="-1">Cancel</button>
                    </div>
                </div>
            </div>
            
        </form>
    </div>
</div>
